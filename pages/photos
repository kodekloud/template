<div class="main">
     <div class="container">
          <section class="hgroup">
               <h1>Photos</h1>
               <ul class="breadcrumb pull-right">
                    <li><a href="/home">Home</a> </li>
                    <li><a href="/leasing">Leasing</a> </li>
                    <li class="active">Photos</li>
               </ul>
          </section>
          <section class="portfolio_strict">
                <div class="row isotope_portfolio_container" id="photo_container">
                    <script id="photo_template" type="x-tmpl-mustache">
                        <div class="cat_travel col-xs-12 col-sm-6 col-md-4 col-lg-4">
                            <div class="portfolio_item"> 
                                <a href="#" data-path-hover="M 180,190 0,158 0,0 180,0 z">
                                    <figure style="background-image:url({{alt_url}})">
                                        <svg viewBox="0 0 180 320" preserveAspectRatio="none">
                                            <path d="M 180,0 0,0 0,0 180,0 z"/>
                                        </svg>
                                        <figcaption>
                                            <p>{{description}}</p>
                                            <div class="view_button">View</div>
                                        </figcaption>
                                    </figure>
                                </a>
                             </div>
                        </div>
                    </script>
               </div>
          </section>
     </div>
</div>


<script>
    $(document).ready(function() {
         
        function renderPageData(){
            var repoList = getRepoList();  
            renderPhotos("#photo_container", "#photo_template", repoList);
        }
        function renderPhotos(container, template, collection){
            var item_list = [];
            var item_rendered = [];
            var template_html = $(template).html();
            Mustache.parse(template_html);   // optional, speeds up future uses
            $.each( collection , function( key, val ) {
                if( val.name == "photos"){
                    $.each( val.images , function( key, val ) {
                        val.alt_url = getImageURL(val.photo_url);
                        item_list.push(val);
                        
                    });
                }
            });
            $.each( item_list , function( key, val ) {
                var repo_rendered = Mustache.render(template_html,val);
                item_rendered.push(repo_rendered);
            });
            
            $(container).show();
            $(container).html(item_rendered.join(''));    
        }
         
        function getImageURL(existing_url){
            if(!existing_url ||  existing_url.indexOf('missing.png') > -1 || existing_url.length === 0){
                //http://css-tricks.com/snippets/html/base64-encode-of-1x1px-transparent-gif/
                return "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";
                
            }
            return "http://cdn.mallmaverickstaging.com"+existing_url;
        }
        loadMallData(renderPageData);
     });
     
</script>